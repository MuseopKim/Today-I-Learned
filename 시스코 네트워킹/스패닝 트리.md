# 스패닝 트리

## 스패닝 트리 알고리즘

> 스위치나 브리지에서 발생하는 루핑을 막아주기 위한 프로토콜. 스위치나 브리지 구성에서 출발지로부터 목적지까지의 경로가 2개 이상 존재할 때, 1개의 경로만을 남겨두고 모두 끊어두었다가 사용하던 경로에 문제가 발생하면 그때 끊어 두었던 경로를 다시 살리는 것

### 브리지 ID

브리지나 스위치들이 통신할 때 서로를 확인하기 위해 하나씩 가지고 있는 번호. 2바이트의 Bridge Priority와 6바이트의 맥 어드레스로 구성 된다. 스패닝 트리 프로토콜을 수행할 때 아주 중요한 값으로 사용 된다.

- Bridge Priority : 아무런 구성도 하지 않은 스위치나 브리지에서 디폴트 값 32768을 사용한다.
- 맥 어드레스 : 스위치에 고정되어 있는 값

### Path Cost

'길을(장비와 장비가 연결되어 있는 링크) 가는 데 드는 비용' . 즉, 브리지가 얼마나 가까이, 그리고 빠른 링크로 연결되어 있는지를 알아내기 위한 값.

```markdown
# 기본 계산 법

1000Mbps / [둘 사이의 링크 대역폭]

# 소수점을 방지하기 위해 IEEE에서 각 속도마다 Path Cost 정수 값을 따로 정의 해놓았다.
```

링크의 속도가 빠르면 빠를수록 더 작은 값이 된다. ⇒ 링크 속도가 빠르면 그만큼 빨리 도착할테니 Path Cost는 작아진다.

---

## 스패닝 트리를 이해하기 위한 3가지 동작

### 네트워크당 하나의 루트 브리지를 갖는다.

> 하나의 브로드캐스트 도메인에 하나씩의 루트 브리지가 있다.

> 루트 브리지 : 스패닝 프로토콜을 수행할 때 기준이 되는 브리지(스위치)

### 루트 브리지가 아닌 나머지 모든 브리지는 무조건 하나씩의 루트 포트를 갖는다.

> 루트 브리지가 아닌 브리지(Non Root Bridge)는 하나씩의 루트 포트를 가져야 한다.

> 루트 포트 : 루트 브리지에 가장 빨리 갈 수 있는 가장 가까운 포트

### 세그먼트당 하나씩의 데지그네이티드 포트(Designated Port)를 갖는다.

> 세그먼트 : 브리지 또는 스위치 간에 서로 연결된 링크

> 브리지나 스위치가 서로 연결되어 있을 때 세그먼트에서 반드시 한 포트는 Designated Port로 선출 되어야 한다.

**루트 포트, 데지그네이티드 포트로 선정되지 못한 포트는 모두 막아버린다.**

---
