

---



## 쿼리 실행 구조

### 파서

사용자 요청으로 들어온 쿼리 문장을 토큰으로 분리해 트리 형태의 구조로 만들어내는 작업



### 전처리기

파서 트리를 기반으로 각 토큰을 테이블, 컬럼, 내장 함수와 같은 개체를 매핑하여 유효성 검사를 수행



### 옵티마이저

사용자 요청으로 들어온 쿼리 문장을 어떻게 저렴한 비용으로 가장 빠르게 처리할지 결정하는 역할



### 실행 엔진

옵티마이저의 결정에 따라 핸들러에게 요청을 전달. 옵티마이저가 두뇌 역할이라면 실행 엔진과 핸들러는 손과 발에 비유할 수 있다.



### 핸들러(스토리지 엔진)

MySQL 서버의 가장 밑단에서 MySQL 실행 엔진의 요청에 따라 데이터를 디스크로 저장하고 읽어오는 역할



---



## 복제

MySQL이 확장성을 위해 제공하는 다양한 기술 중 하나. 2대 이상의 MySQL 서버가 동일한 데이터를 담도록 실시간으로 동기화한다. 일반적으로 INSERT, UPDATE와 같은 쿼리로 데이터를 변경할 수 있는 MySQL 서버와 SELECT 쿼리로 데이터를 읽기할 수 있는 MySQL 서버로 나눈다. 보통 전자를 마스터, 후자를 슬레이브라고 한다.



### 마스터

마스터 장비는 주로 데이터가 생성, 변경, 삭제되는 주체라 볼 수 있다. 일반적으로 데이터의 일관성을 보장하기 위해 여러 서버 가운데 변경이 허용되는 서버는 마스터로 한정할 때가 많다. DML, DDL 쿼리 문장은 바이너리 로그에 기록한다.



### 슬레이브

마스터와 슬레이브의 데이터를 동일한 상태로 유지하기 위해 슬레이브 서버는 읽기 전용 (read_only 파라미터 참조)으로 설정할 때가 많다. 마스터 서버에 변경 내역을 요청하고, 받아 온 변경 내역을 릴레이 로그에 기록한다. 이렇게 기록된 릴레이 로그 변경 내역을 재실행하여 마스터와 동일한 데이터를 유지한다.



---



## 쿼리 캐시

MySQL만의 독특한 기능 중 하나다. 여러 가지 복잡한 처리 절차, 비용을 들여 실행된 결과를 쿼리 캐시에 담아 두고, 동일한 쿼리 요청이 왔을 때 간단하게 쿼리 캐시에서 찾아 바로 결과를 내려 줄 수 있다. 이 때 쿼리 캐시의 의미는 SQL 문장을 캐시하는 것이 아니라, 쿼리의 결과를 메모리에 캐시해 두는 기능을 말한다.



**트랜잭션 ID**

InnoDB의 모든 트랜잭션은 각 트랜잭션 ID를 갖게 되는데, 트랜잭션이 시작된 시점을 기준으로 순차적으로 증가하는 값이다. 이 ID 값을 비교 함으로써 어느 쪽이 먼저 시작된 트랜잭션인지 구분이 가능하다. 따라서 트랜잭션 격리 수준을 준수하기 위해 각 트랜잭션은 자신의 ID보다 ID 값이 큰 트랜잭션에서 변경한 작업 내역이나 쿼리 결과는 참조할 수 없다. 이를 트랜잭션 가시 범위라 한다.