------



## 집계함수

여러 행들의 그룹이 모여서 그룹당 단 하나의 결과를 돌려주는 다중 행 함수중 하나. 다음의 특성을 갖는다.

- 여러 행들의 그룹이 모여 그룹당 단 하나의 결과를 돌려준다.
- GROUP BY 절은 행들을 소그룹화 한다.
- SELECT, HAVING, ORDER BY 절에 사용 할 수 있다.

### 집계 함수의 종류

- COUNT(*) : NULL 값을 포함한 행의 수 출력
- COUNT(표현식) : NULL 값인 것을 제외한 행 수 출력
- SUM([DISTINCT | ALL] 표현식) : NULL 값을 제외한 합계 출력
- AVG([DISTINCT | ALL] 표현식) : NULL 값을 제외한 평균 출력
- MAX([DISTINCT | ALL] 표현식) : 표현식의 최댓값 출력 (문자, 날짜 데이터 역시 가능)
- MIN([DISTINCT | ALL] 표현식) : 표현식의 최솟값 출력 (문자, 날짜 데이터 가능)
- STDDEV([DISTINCT | ALL] 표현식) : 표현식의 표준 편차 출력
- VARIANCE/VAR([DISTINCT | ALL] 표현식) : 표현식의 분산을 출력



------



## GROUP BY, HAVING의 특징

- GROUP BY 절을 통해 소그룹별 기준을 정하고, SELECT 절에 집계함수를 사용한다.
- 집계함수의 통계 정보는 NULL 값을 가진 행을 제외하고 수행한다.
- GROUP BY 절에서는 SELECT 절과는 달리 ALIAS 명을 사용할 수 없다.
- 집계함수는 WHERE 절에 올 수 없다. (GROUP BY 보다 WHERE절이 먼저 수행된다.)
- WHERE 절은 전체 데이터를 GROUP으로 나누기 전에 행들을 미리 제거한다.
- HAVING 절은 GROUP BY 절의 기준 항목이나 소그룹의 집계함수를 이용한 조건을 걸 수 있다.
- GROUP BY 절에 의한 소그룹별로 만들어진 집계 데이터 중 HAVING 절에서 제한 조건을 두어 조건을 만족하는 내용만 출력한다.
- HAVING절은 일반적으로 GROUP BY 절 뒤에 위치한다.



------



GROUP BY 절에서 그룹핑 기준을 정의하면 데이터베이스는 일반적인 SELECT 문장처럼 FROM 절에 정의 된 테이블의 구조를 그대로 가져가지 않는다. GROUP BY 절에서 소그룹화 한 컬럼, 집계함수에 사용될 수 있는 숫자형 데이터 컬럼의 집합을 새로 만들게 된다.

GROUP BY 절을 사용하면 그룹핑 기준에 사용된 컬럼, 집계함수에 사용될 수 있는 숫자형 데이터 컬럼들의 집합을 새로 만드는데, 개별 데이터는 필요 없기 때문에 저장하지 않는다. 따라서 GROUP BY 수행 이후에 SELECT, ORDER BY 에서 개별 데이터를 사용하려고 하면 에러가 발생한다.

즉, 그룹핑 기준, 숫자 형식 컬럼 (집계함수) 이외에 문자 형식의 컬럼은 사용 할 수 없다.