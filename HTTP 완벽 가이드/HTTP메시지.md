## HTTP 메시지

---



## 메시지의 흐름

HTTP 메시지는 HTTP 애플리케이션 간에 주고받은 데이터의 블록들이다. 이 데이터 블록들은 메시지의 내용과 의미를 설명하는 텍스트 메타 정보로 시작하고, 그 다음에 선택적으로 데이터가 올 수 있다. 메시지의 방향을 의미하는 용어로는 '인바운드', '아웃바운드', '업스트림', '다운스트림'이 있다.



### 메시지는 원 서버 방향을 인바운드 하여 송신된다

메시지가 원 서버로 향하는 것은 인바운드(서버방향)로 이동하는 것이고, 모든 처리가 끝난 뒤에 메시지가 사용자 에이전트로 돌아오는 것을 아웃바운드(클라이언트 방향)로 이동한다고 한다.



### 다운스트림으로 흐르는 메시지

요청 메시지, 응답 메시지 여부에 관계 없이 모든 메시지는 다운스트림으로 흐른다. 메시지의 발송자는 수신자의 업스트림이다.



---



## 메시지의 각 부분

HTTP 메시지는 데이터의 구조화된 블록이다. 각 메시지는 요청 혹은 응답이며, 시작줄, 헤더, 블록, 본문 이렇게 세 부분으로 이루어진다. 시작줄은 이것이 어떤 메시지인지를 서술하며, 헤더 블록은 속성, 본문은 데이터를 담고 있다. 이 때 본문은 생략 가능하다. 시작줄과 헤더 및 각 줄은 아스키 문자열이며 모두 줄바꿈 문자열(CRLF)으로 끝이난다. 엔터티 본문이나 메시지 본문은 시작줄이나 헤더와 달리 텍스트나 이진 데이터를 모두 포함할 수도 있다.



### 메시지 문법

모든 HTTP 메시지는 요청 혹은 응답 메시지로 분류된다. 요청 메시지는 웹 서버에 어떤 동작을 요구하며, 응답 메시지는 요청의 결과를 클라이언트에게 돌려준다. 각 메시지는 다음의 요소들을 포함한다.



**메서드**

클라이언트 측에서 서버가 리소스에 대해 수행해주길 바라는 동작. GET, POST, HEAD, 등 여러가지가 있다.



**요청 URL**

요청 대상이 되는 리소스를 지칭하는 완전한 URL 혹은 URL의 경로 구성요소.



**버전**

이 메시지에서 사용 중인 HTTP의 버전이다.



**상태코드**

요청 중 어떤 일이 일어났는지 설명하는 세자리의 숫자이다. 각 코드의 첫 째 자리 수는 상태의 일반적인 분류(성공, 에러) 등을 나타낸다.



**사유 구절**

숫자로 된 상태 코드의 의미를 사람이 이해할 수 있게 설명해주는 짧은 문구. 사유 구절은 오직 사람에게 읽히기 위한 목적으로만 존재한다.



**헤더**

이름, 콜론, 선택적인 공백 값, CRLF가 순서대로 0개 이상 나타난다. CRLF로 끝나 엔터티 본문의 시작을 표시한다.



**엔터티 본문**

임의의 데이터 블록이다. 모든 메시지가 엔터티 본문을 갖는 것은 아니다. 헤더나 엔터티 본문이 없더라도 HTTP 헤더의 집합은 항상 빈 줄로 끝나야 한다.



### 시작줄

모든 HTTP 메시지는 시작줄로 시작한다. 요청 메시지의 시작줄은 무엇을 해야 하는지 말해주고, 응답 메시지의 시작줄은 무슨 일이 일어났는지 말해준다.



**요청줄**

요청 메시지는 서버에게 리소스에 대해 무언가를 해달라고 요청한다. 여기에는 동작을 설명하는 키워드인 메서드, 그 동작의 대상인 요청 URL, HTTP 버전이 포함된다. 모든 필드는 공백으로 구분된다.



**응답줄**

응답 메시지는 수행 결과에 대한 상태 정보와 결과 데이터를 클라이언트에게 돌려준다. 응답줄은 HTTP 버전, 상태코드, 사유 구절로 구성된다.



**메서드**

HTTP 요청 메서드는 다음과 같다.

- GET : 서버에서 어떤 문서를 가져온다.
- HEAD : 서버에서 어떤 문서에 대해 헤더만 가져온다.
- POST : 서버가 처리해야 할 데이터를 보낸다.
- PUT : 서버에 요청 메시지의 본문을 저장한다.
- TRACE : 메시지가 프락시를 거쳐 서버에 도달하는 과정을 추적한다.
- OPTIONS : 서버가 어떤 메서드를 수행할 수 있는지 확인한다.
- DELETE : 서버에서 문서를 제거한다.



**상태코드**

상태 코드는 클라이언트에게 무슨 일이 일어났는지 알려준다. 또한 각 응답 메시지의 시작줄에 담겨 반환된다. 숫자로 된 코드와 문자열로 되어 있어 사람이 이해하기 쉬운 메시지 두 형태 모두로 반환된다.

- 100 ~ : 정보
- 200 ~ : 성공
- 300 ~ : 리다이렉션
- 400 ~ : 클라이언트 에러
- 500 ~ : 서버 에러



**사유 구절**

응답 시작줄의 마지막 구성요소다. 이 것은 상태 코드에 대한 글로 된 설명을 제공한다. 사유 구절은 상태 코드와 일대일로 대응된다.



**버전 번호**

HTTP/x.y 형식으로 요청과 응답 메시지 양쪽 모두에 기술된다. 버전 번호는 어떤 애플리케이션이 지원하는 가장 높은 HTTP 버전을 가리킨다.



### 헤더

시작줄 다음에는 0개 이상의 HTTP 헤더가 올 수 있다. HTTP 헤더 필드는 요청과 응답 메시지에 추가 정보를 더한다. 기본적으로 이름/값 쌍의 목록이다.

**헤더 분류**

HTTP 헤더 명세는 여러 헤더 필드를 정의한다. 헤더는 다음과 같이 분류 된다.

- 일반 헤더 : 요청, 응답 양쪽에 모두 나타날 수 있음

- 요청 헤더 : 요청에 대한 부가 정보를 제공

- 응답 헤더 : 응답에 대한 부가 정보를 제공

- Entity 크기 헤더 : 본문 크기와 콘텐츠, 리소스 그 자체를 서술

- 확장 헤더 : 명세에 정의되지 않은 새로운 헤더

  

헤더는 여러 가지가 올 수 있으며, 긴 헤더 줄은 그들을 여러 줄로 쪼개서 더 읽기 좋게 만들 수 있는데, 추가 줄 앞에는 최소 하나의 스페이스 혹은 탭 문자가 와야 한다.



### 엔터티 본문

HTTP 메시지의 세 번째 부분은 선택적인 엔터티 본문이다. 엔터티 본문은 HTTP 메시지의 화물이라고 할 수 있다. HTTP 메시지는 여러 포맷의 디지털 데이터를 실어 나를 수 있다.

